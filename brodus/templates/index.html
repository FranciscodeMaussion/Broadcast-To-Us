{% extends 'base.html' %}
{% load static %}
{% block titulo %}
<title>Inicio</title>
{% endblock %}
{% block content %}
<div class="row">
    <div class="card-panel col s10 push-s1">
        <h5 class="center">PROYECTOS</h5>
        <table class="highlight centered">
            <thead>
                <tr>
                    <th data-field="nombre">Nombre</th>
                    <th data-field="desc">Descripci칩n</th>
                    <th data-field="idi">Idioma</th>
                    <th data-field="len">Lenguaje de Programaci칩n</th>
                    <th data-field="trab">Trabajos</th>
                    <th data-field="due침o">Empleador</th>
                </tr>
            </thead>
            <tbody id="invite_proj">
                {% for j in rol_user.proj_user.all %}
                <tr>
                    <td>{{j.nombre}}</td>
                    <td><textarea class="materialize-textarea center" disabled style="color: white; border-bottom-style: none; margin-bottom: 0px; padding-bottom: 0px;">{{j.desc}}</textarea></td>
                    <td>
                        {% for i in j.nescesita_i.all %}
                        {% if forloop.last %}
                        {{i.nombre}}
                        {% else %}
                        {{i.nombre}},
                        {% endif %}
                        {% endfor %}
                    </td>
                    <td>
                        {% for l in j.nescesita_l.all %}
                        {% if forloop.last %}
                        {{l.nombre}}
                        {% else %}
                        {{l.nombre}},
                        {% endif %}
                        {% endfor %}
                    </td>
                    <td>
                        {% for w in j.nescesita_w.all %}
                        {% if forloop.last %}
                        {{w.tipo}}
                        {% else %}
                        {{w.tipo}},
                        {% endif %}
                        {% endfor %}
                    </td>
                    <td>{{j.owner}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% if rol_user.su %}
    <div class="card-panel col s10 push-s1">
        <h5 class="center">PETICIONES DE AGREGADO</h5>
        <table class="highlight centered">
            <thead>
                <tr>
                    <th data-field="nombre">Nombre</th>
                    <th data-field="desc">Descripci칩n</th>
                    <th data-field="tipo">tipo</th>
                </tr>
            </thead>
            <tbody id="r_idioma">
                {% include "obj_i.html" %}
            </tbody>
            <tbody id="r_lenguaje">
                {% include "obj_l.html" %}
            </tbody>
            <tbody id="r_trabajo">
                {% include "obj_t.html" %}
            </tbody>
        </table>
    </div>
    {% endif %}
</div>
{% endblock %}
{% block scripts %}
<script>
    function add_active(id,tipo, helper, tDo){
        var data={
            csrfmiddlewaretoken: '{{ csrf_token }}',
            id:parseInt(id.id),
            tipo:tipo,
            tDo:tDo,
        }
        $.ajax({
            method: "POST",
            url: "{% url 'brodus:add_active' %}",
            data: data,
            success:function(result){
                $('#'+helper).html(result);
                if (tDo == "True"){
                    Materialize.toast('Aceptado', 2000);
                }else{
                    Materialize.toast('Eliminado', 2000);
                }
            },
            error: function(e){
                console.log(e.responseText);
                Materialize.toast('Error', 2000);
            },
        });
    }
</script>
{% endblock %}
